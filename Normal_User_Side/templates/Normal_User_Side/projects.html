{% extends 'Normal_User_Side/base_dashboard.html' %}
{% load humanize %}

{% block title %}My Projects - Land Appraisal System{% endblock %}

{% block content %}
<div class="min-h-screen bg-background">
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

    <!-- Header -->
    <div class="flex flex-col sm:flex-row justify-between gap-4 mb-8">
        <div>
            <h1 class="text-3xl font-bold text-foreground">My Projects</h1>
            <p class="text-muted-foreground mt-1">Manage and continue your land appraisal projects</p>
        </div>

        <a href="{% url 'normal_user:new-project' %}" class="btn btn-primary flex items-center gap-2">
            {% include "components/icons/new.html" with class="w-4 h-4" %}
            New Project
        </a>
    </div>

    <!-- Filters -->
    <form method="GET" class="card p-4 mb-6 space-y-4">
        <div class="relative">
            {% include "components/icons/search.html" with class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground" %}
            <input type="text" name="search" value="{{ request.GET.search }}" placeholder="Search projects..." class="input pl-10 w-full">
        </div>

        <div class="flex flex-wrap gap-3">
            <!-- Land type -->
            <select name="land_type" class="input w-48">
                <option value="">All Land Types</option>
                {% for lt in land_types %}
                    <option value="{{ lt }}" {% if request.GET.land_type == lt %}selected{% endif %}>{{ lt }}</option>
                {% endfor %}
            </select>

            <!-- Political -->
            <select select name="political" class="input w-48">
                <option value="">All Classifications</option>
                {% for p in political_types %}
                    <option value="{{ p }}" {% if request.GET.political == p %}selected{% endif %}>{{ p }}</option>
                {% endfor %}
            </select>

            <!-- Status -->
            <select name="status" class="input w-48">
                <option value="">All Statuses</option>
                {% for s in statuses %}
                    <option value="{{ s }}" {% if request.GET.status == s %}selected{% endif %}>{{ s }}</option>
                {% endfor %}
            </select>


            <!-- Sort -->
            <select name="sort" class="input w-48">
                <option value="-date_created">Newest First</option>
                <option value="date_created">Oldest First</option>
                <option value="name">Name A-Z</option>
                <option value="-name">Name Z-A</option>
                <option value="-estimated_price">Price: High to Low</option>
                <option value="estimated_price">Price: Low to High</option>
            </select>

            <button class="btn btn-secondary">Apply Filters</button>
            <a href="{% url 'normal_user:projects'%}" class="btn btn-outline">Clear</a>
        </div>
    </form>

    <!-- Results count -->
    <p class="text-sm text-muted-foreground mb-4">
        Showing <span class="font-medium text-foreground">{{ projects|length }}</span> project{{ projects|length|pluralize }}
    </p>

    <!-- Grid -->
    <section>
    <div id="projectsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">

        {% for project in projects %}
    <div class="project-box">

        <h3>{{ project.title }}</h3>

        <p><strong>Land Type:</strong> {{ project.get_land_type_display }}</p>
        <p><strong>Political Type:</strong> {{ project.get_political_display }}</p>
        <p><strong>Status:</strong> {{ project.get_status_display }}</p>

    </div>
{% endfor %}

</section>

{% endblock %}
